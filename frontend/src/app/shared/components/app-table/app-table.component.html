<div class="app-table-container">
  <div class="loading-shade" *ngIf="loading">
    <mat-progress-spinner mode="indeterminate" [diameter]="48"></mat-progress-spinner>
  </div>

  <div class="table-responsive">
    <table mat-table [dataSource]="data" matSort (matSortChange)="sort.emit($event)" class="full-width">
      <ng-container *ngFor="let col of columns" [matColumnDef]="col.key">
        <th mat-header-cell *matHeaderCellDef
            [mat-sort-header]="col.key"
            [disabled]="!col.sortable"
            [ngStyle]="col.style">
          {{ col.label }}
        </th>
        <td mat-cell *matCellDef="let element" [ngStyle]="col.style">

          <ng-container [ngSwitch]="col.type">
            <ng-container *ngSwitchCase="'date'">
              {{ element[col.key] | date:'MMM dd, HH:mm' }}
            </ng-container>

            <ng-container *ngSwitchCase="'template'">
              <ng-container *ngTemplateOutlet="cellTemplate; context: { $implicit: element, key: col.key }"></ng-container>
            </ng-container>

            <ng-container *ngSwitchDefault>
              {{ element[col.key] }}
            </ng-container>
          </ng-container>

        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="columnKeys"></tr>
      <tr mat-row *matRowDef="let row; columns: columnKeys;" class="animate-fade"></tr>

      <tr class="mat-row" *matNoDataRow>
        <td class="mat-cell" [attr.colspan]="columns.length" style="padding: 64px 24px; text-align: center;">
          <div class="empty-state-content" style="display: flex; flex-direction: column; align-items: center; gap: 12px;">
            <mat-icon style="font-size: 56px; width: 56px; height: 56px; opacity: 0.15; color: var(--primary);">inventory_2</mat-icon>
            <p style="color: var(--text-muted); font-weight: 600; font-size: 16px; margin: 0;">No active records found</p>
            <span style="font-size: 13px; color: var(--text-muted); opacity: 0.7;">Adjust your filters or sync the engine to retrieve data.</span>
          </div>
        </td>
      </tr>
    </table>
  </div>

  <mat-paginator *ngIf="showPaginator"
                 [length]="totalCount"
                 [pageSize]="pageSize"
                 [pageSizeOptions]="pageSizeOptions"
                 (page)="page.emit($event)"
                 aria-label="Select page">
  </mat-paginator>
</div>
